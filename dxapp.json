{
  "name": "mrcepid-buildgrms",
  "title": "BuildGRMs",
  "summary": "Generates a variety of Relatedness Matrices for various burden testing methods",
  "dxapi": "1.0.0",
  "version": "1.0.0",
  "openSource": true,
  "inputSpec": [
    {
      "name": "genetic_data_file",
      "label": "Path to a genetic coordinates file, pointing to UKBB genetic (array) data.",
      "class": "string",
      "optional": false,
      "help": "Full file-path to a file that contains coordinates which point to the UKBB genetic (array) data. See the README for how this file should be formatted."
    },
    {
      "name": "sample_ids_file",
      "label": "List of samples with WES data",
      "class": "file",
      "optional": false,
      "help": "List of sample IDs for current application with one sample ID per line."
    },
    {
      "name": "ancestry_file",
      "label": "List of individuals with assigned ancestry status.",
      "class": "file",
      "optional": false,
      "help": "List of individuals demarcated by ancestry for current application with one sample ID per line. Ancestry label must be one of eur, sas, afr, or NA."
    },
    {
      "name": "snp_qc",
      "label": "A SNP QC file for inclusion/exclusion of variants.",
      "class": "file",
      "optional": false,
      "help": "This file should contain variant-level QC information from the sequencing experiments."
    },
    {
      "name": "sample_qc",
      "label": "A sample QC file for inclusion/exclusion of samples.",
      "class": "file",
      "optional": false,
      "help": "This file should contain any sample-level QC information from the sequencing experiments."
    },
    {
      "name": "ukb_snp_qc",
      "label": "List of individuals with assigned ancestry status.",
      "class": "file",
      "optional": false,
      "help": "This is a UK Biobank specific snp QC file. It's only required when using the UK Biobank data."
    },
    {
      "name": "ukb_snps_qc_v2",
      "label": "This is an additional UK Biobank specific snp QC file.",
      "class": "file",
      "optional": false,
      "help": "This is an additional UK Biobank specific snp QC file. It's only required when using the UK Biobank data."
    },
    {
        "name": "relatedness_file",
        "label": "This is a UK Biobank specific relatedness file.",
        "class": "file",
        "optional": true,
        "help": "This file contains information about relatedness between individuals in the UK Biobank dataset. If it's not provided, the app will generate a relatedness matrix based on the genetic data file."
        }
  ],
  "outputSpec": [
    {
      "name": "output_pgen",
      "label": "Output filtered pgen file limited to pass SNPs and WES individuals",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.pgen"
      ],
      "help": "SNP/Sample-filtered autosomal plink format file."
    },
    {
      "name": "output_psam",
      "label": "Output filtered psam file limited to pass SNPs and WES individuals",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.psam"
      ],
      "help": "Associated sample file"
    },
    {
      "name": "output_pvar",
      "label": "Output filtered pvar file limited to pass SNPs and WES individuals",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.pvar"
      ],
      "help": "Associated variant file"
    },
    {
      "name": "inclusion_lists",
      "label": "List of related and unrelated individuals for all ancestries.",
      "class": "array:file",
      "optional": false,
      "patterns": [
        "*.txt"
      ],
      "help": "Two lists for each ancestry to generate related and unrelated subsets as well as an 'ALL' category."
    },
    {
      "name": "grm",
      "label": "genetic relatedness matrix to use for association testing",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.mtx"
      ],
      "help": "SAIGE-compatible GRM"
    },
    {
      "name": "grm_samp",
      "label": "sample file for the genetic relatedness matrix to use for association testing",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.mtx.sample"
      ],
      "help": "Associated .sample file"
    },
    {
      "name": "snp_list",
      "label": "list of low MAC variants for exclusion purposes",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.snplist"
      ],
      "help": "List of low MAC SNPs to exclude from BOLT"
    }
  ],
  "runSpec": {
    "timeoutPolicy": {
      "*": {
        "hours": 48
      }
    },
    "interpreter": "python3",
    "file": "buildgrms/build_grms.py",
    "distribution": "Ubuntu",
    "release": "20.04",
    "version": "0",
    "execDepends": [
      {
        "name": "uv",
        "package_manager": "pip"
      },
      {
        "name": "mrcepid-buildgrms",
        "package_manager": "git",
        "url": "https://github.com/mrcepid-rap/mrcepid-buildgrms.git",
        "tag": "main",
        "build_commands": "uv pip install --system ."
      }
    ]
  },
  "access": {
    "network": [
      "*"
    ]
  },
  "regionalOptions": {
    "aws:eu-west-2": {
      "systemRequirements": {
        "*": {
          "instanceType": "mem2_ssd1_v2_x32"
        }
      }
    }
  }
}
